apex_prime:
  version: "33.0.1"
  epoch: "33Ω"
  role: "Soul-Governor / Constitutional Judiciary"
  description: >
    APEX PRIME is the non-generative judiciary engine of arifOS.
    It enforces ΔΩΨ laws and all constitutional floors at seal-time,
    computes Ψ vitality, and issues SEAL / PARTIAL / VOID verdicts.

  floors:
    truth:
      threshold: 0.99
    delta_s:
      threshold: 0.0
    peace_squared:
      threshold: 1.0
    kappa_r:
      threshold: 0.95
    omega_0:
      min: 0.03
      max: 0.05
    rasa:
      required: true
    amanah:
      required: true
    tri_witness:
      threshold: 0.95
    psi:
      threshold: 1.0

  psi_equation:
    expression: "(delta_s * peace_squared * kappa_r * truth * rasa_flag * amanah_flag) / (entropy + shadow + epsilon)"
    epsilon: 1.0e-6
    bands:
      high: 1.10
      normal_min: 0.95
      warning_min: 0.85

  pipeline:
    stages:
      - id: "444"
        name: "ALIGN"
        responsibility: "Soft floor pre-check; bounce back early if obvious breach."
      - id: "888"
        name: "AUDIT"
        responsibility: "Judge floors, Ψ, Tri-Witness, and organ vetoes."
      - id: "999"
        name: "SEAL"
        responsibility: "Emit SEAL/PARTIAL/VOID and write Cooling Ledger entry."

  verdicts:
    allowed:
      - "SEAL"
      - "PARTIAL"
      - "VOID"
    seal_condition: "all_floors_green and psi >= psi_threshold"
    partial_condition: "non_critical_floors_marginal and psi >= psi_partial_min"
    void_condition: "critical_floor_failure or psi < psi_partial_min"

  interfaces:
    inputs:
      - name: "candidate_output"
        type: "str"
      - name: "metrics"
        type: "ConstitutionalMetrics"
      - name: "organ_vetoes"
        type: "dict"
      - name: "context"
        type: "dict"
      - name: "high_stakes"
        type: "bool"
    outputs:
      - name: "verdict"
        type: "str"
      - name: "reason"
        type: "str"
      - name: "metrics_out"
        type: "ConstitutionalMetrics"
      - name: "logging_info"
        type: "dict"

  invariants:
    - "APEX PRIME must not generate content."
    - "All high-stakes outputs must pass through APEX PRIME before emission."
    - "Floor thresholds must not be lowered without Phoenix-72 + constitutional update."